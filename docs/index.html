<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Survival Model Simulation • survMS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Survival Model Simulation">
<meta property="og:description" content="Package enables to simulate survival models (Cox, AFT and AH) with different levels of complexity.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">survMS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="articles/index.html">
    <span class="fa fa-book"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-code"></span>
     
    Functions Documentation
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mathildesautreuil/survMS">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="survms-r-package-survival-model-simulation" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#survms-r-package-survival-model-simulation" class="anchor"></a>survMS R package: survival Model Simulation</h1></div>
<!-- README.md is generated from README.Rmd. Please edit that file -->
</div>
<div id="new-hostinginstallation" class="section level1">
<h1 class="hasAnchor">
<a href="#new-hostinginstallation" class="anchor"></a>New hosting/Installation</h1>
<!-- badges: start -->

<p><a href="https://github.com/mathildesautreuil/survMS" class="uri">https://github.com/mathildesautreuil/survMS</a></p>
<p>Install from CRAN:</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"survMS"</span><span class="op">)</span></code></pre></div>
<p>Or install the development version from Github:</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"mathildesautreuil/survMS"</span><span class="op">)</span></code></pre></div>
<p>And load the library:</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mathildesautreuil/survMS/">survMS</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ggplot2</span></code></pre></div>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>1 Introduction</h1>
<p><strong>survMS</strong> is an R package that generates survival data from different survival models with varying levels of complexity. Three survival models are implemented in the package to simulate survival data: a Cox model, an Accelerated Failure Time (AFT) model, and an Accelerated Hazard (AH) model. These models have their specificities. Indeed, a Cox model is a proportional risk model, not an AFT and an AH model. A proportional risk model means that the ratio of the risks between two individuals with different explanatory variables does not depend on the time. In an AFT model, the explanatory variables have an accelerating or decelerating effect on individuals’ survival. In both models, a Cox model and an AFT model, the survival function’s curves never intersect. When one is interested in more complex data with intersecting survival curves, for example, to make it more difficult for methods to predict survival, two approaches are implemented in the package. The first approach consists of modifying an AFT model to have intersecting survival curves. The second approach concerns using of an AH model (for <em>Accelerated Hazards</em>) to generate the survival data. an AH model is more flexible than the two models mentioned above. In an AH model, the variables accelerate or decelerate the hazard risk. The survival curves of an AH model can therefore cross each other. The generation of survival times carried out from the different models mentioned above. The baseline risk function of the models is assumed to be known and follows a particular probability distribution. For these different models, we use parametric distribution of the baseline risk for the generation of survival time.</p>
<p>Note that we stayed in a linear dependency framework without interaction. We will adapt the package in a second step to be in a nonlinear framework to simulate interactions. The package’s implementation is easily adapted to the nonlinear framework with interactions by replacing the explanatory variables’ linear part with a nonlinear function of the explanatory variables. All the functions in the package are coded to introduce this nonlinear function of the explanatory variables easily.</p>
<p>For details on methodology, see <a href="https://mathildesautreuil.github.io/survMS/articles/How-to-simulate-survival-models.html">Vignette</a>. <!-- ## Reminder of the functions used in survival analysis --></p>
<!-- The table below summarizes the writing of the functions used in survival analysis (instantaneous risk $\lambda(t)$, cumulative risk function $H_0(t)$, survival function $S(t)$ and density $f(t)$) for each of the models considered (Cox, AFT and AH) for the generation of survival data. -->
<!-- |                         | Cox                                                           | AFT                                                     | AH                                                         | -->
<!-- |-------------------------|---------------------------------------------------------------|---------------------------------------------------------|------------------------------------------------------------| -->
<!-- | $$H(t|X_{i.})$$     | $$H_0(t)\exp(\beta^T X_{i.})$$                                | $$H_0(t\exp(\beta^T X_{i.}))$$                          | $$ H_0(t\exp(\beta^T X_{i.}))\exp(-\beta^T X_{i.})$$       | -->
<!-- | $$\lambda(t|X_{i.})$$ | $$\alpha_0(t)\exp(\beta^T X_{i.})$$                           | $$\alpha_0(t\exp(\beta^T X_{i.}))\exp(\beta^T X_{i.})$$ | $$\alpha_0(t\exp(\beta^T X_{i.}))$$                        | -->
<!-- | $$S(t|X_{i.})$$       | $$S_0(t)^{\exp(\beta^T X_{i.})}$$                             | $$S_0(t\exp(\beta^T X_{i.}))$$                          | $$S_0(t\exp(\beta^T X_{i.}))^{\exp(-\beta^T X_{i.})}$$     | -->
<!-- | $$f(t|X_{i.})$$     | $$f_0(t) \exp(\beta^T X_{i.}) S_0(t)^{\exp(\beta^T X_{i.})}$$ | $$f_0(t\exp(\beta^T X_{i.})) \exp(\beta^T X_{i.})$$     | $$f_0(t \exp(\beta^T X_{i.})) S_0(t\exp(\beta^T X_{i.}))^{(\exp(-\beta^T X_{i.})-1)}$$ | -->
<!-- ## Survival times generation -->
<!-- The models considered are composed of one function, $\alpha_0(t)$, with the baseline risk and the parameters $\beta,$ reflecting the effect of the variables on survival times. For data generation, we assume that the base risk function $\alpha_0(t)$ is known and therefore follows a probability distribution. For this initial version of the package, the baseline hazard distributions are Weibull and log-normale.  These distribution characteristics are summarized in the table below, showing the correspondences in terms of baseline risk and cumulative risk. -->
<!-- |                            | Weibull                                                                                                            | Log-normale                                       | -->
<!-- |----------------------------|--------------------------------------------------------------------------------------------------------------------|---------------------------------------------------| -->
<!-- | Parameters                 | $$\lambda > 0 \text{ (échelle)}$$ $$a > 0 \text{ (forme)}  $$                                                     | $$\mu \in ]-\infty,+\infty[$$   $$\sigma > 0$$  | -->
<!-- | Support                    | $$[0,+\infty[$$                                                                                                    | $$]0,+\infty[$$                                   | -->
<!-- | Baseline hazard            | $$\alpha_0(t) = \lambda a t^{(a-1)}$$                                                         | $$\alpha_0(t) = \frac{\frac{1}{\sigma\sqrt{2\pi t}} \exp\left[-\frac{(\log t - \mu)^2 }{2 \sigma^2}\right]}{1 - \Phi\left[\frac{\log t - \mu}{\sigma}\right]}$$ | -->
<!-- | Cumulative Hazards         | $$H_0(t) = \lambda t^{a}$$                                                                                         | $$H_0(t) = - \log\left(1 - \Phi\left[\frac{\log t - \mu}{\sigma}\right]\right)          $$                                                                     | -->
<!-- | Inverse cumulative hazards | $$H_0^{-1}(u) = \left( \frac{u}{\lambda} \right)^{1/a}$$                                                           | $$H_0^{-1}(u) = \exp(\sigma\Phi^{-1}(1-\exp(-u))+\mu)                                   $$                                                                     | -->
<!-- | Density                    | $$f(t) = \lambda a t^{(a-1)} \exp(-\lambda t^{a})         $$                                                       | $$f(t) =  \exp\left[-\frac{(\log t - \mu)^2 }{2 \sigma^2}\right] \frac{1}{\sigma t \sqrt{2\pi }}                    $$                                       | -->
<!-- | Cumulative function        | $$F(t) = \exp(-\lambda t^{a})    $$                                                                                | $$F(t) = 1 - \Phi\left[\frac{\log t - \mu}{\sigma}\right]                             $$                                                                       | -->
<!-- | Expectation                | $$\mathbb{E}(T) =  \Gamma(\frac{1}{a} + 1) \frac{1}{\sqrt[a]{\lambda}}$$                                         | $$\mathbb{E}(T) = \exp (\mu + \frac{\sigma^2}{2})                                     $$                                                                       | -->
<!-- | Variance                   | $$\mathbb{V}(T) =  \left[ \Gamma(\frac{2}{a} + 1) - \Gamma^2(\frac{1}{a} + 1)\right] \frac{1}{\sqrt[a]{\mu^2} }$$ |  $$\mathbb{V}(T) = (\exp(\sigma^2) -1) \exp(2\mu+\sigma^2)                           $$                                                                        | -->
<!-- |                            |                                                      Weibull                                                      |                                                                           Log-normale                                                                           | -->
<!-- |----------------------------|:-----------------------------------------------------------------------------------------------------------------:|:---------------------------------------------------------------------------------------------------------------------------------------------------------------:| -->
<!-- | Parameters                 |                            $$\lambda > 0$$ \text{ (échelle)}  $$a > 0$$ \text{ (forme)}                           |                                                         $$\mu \in ]-\infty,+\infty[$$     $$\sigma > 0$$                                                        | -->
<!-- | Support                    |                                                  $$\mathbb{R}^{+}$$                                                  |                                                                         $$\mathbb{R}^{+}_{\star}$$                                                                         | -->
<!-- | Baseline hazard            |                                       $$\alpha_0(t) = \lambda a t^{(a-1)}$$                                       | $$\alpha_0(t) = \frac{\frac{1}{\sigma\sqrt{2\pi t}} \exp\left[-\frac{(\log t - \mu)^2 }{2 \sigma^2}\right]}{1 - \Phi\left[\frac{\log t - \mu}{\sigma}\right]}$$ | -->
<!-- | Cumulative Hazards         |                                             $$H_0(t) = \lambda t^{a}$$                                            |                                         $$H_0(t) = - \log\left(1 - \Phi\left[\frac{\log t - \mu}{\sigma}\right]\right)$$                                        | -->
<!-- | Inverse cumulative hazards |                              $$H_0^{-1}(u) = \left( \frac{u}{\lambda} \right)^{1/a}$$                             |                                                     $$H_0^{-1}(u) = \exp(\sigma\Phi^{-1}(1-\exp(-u))+\mu)$$                                                     | -->
<!-- | Density                    |                                $$f(t) = \lambda a t^{(a-1)} \exp(-\lambda t^{a})$$                                |                                $$f(t) =  \exp\left[-\frac{(\log t - \mu)^2 }{2 \sigma^2}\right] \frac{1}{\sigma t \sqrt{2\pi }}$$                               | -->
<!-- | Cumulative function        |                                          $$F(t) = \exp(-\lambda t^{a})$$                                          |                                                   $$F(t) = 1 - \Phi\left[\frac{\log t - \mu}{\sigma}\right]$$                                                   | -->
<!-- | Expectation                |                      $$\mathbb{E}(T) =  \Gamma(\frac{1}{a} + 1) \frac{1}{\sqrt[a]{\lambda}}$$                     |                                                       $$\mathbb{E}(T) = \exp (\mu + \frac{\sigma^2}{2})$$                                                       | -->
<!-- | Variance                   | $$\mathbb{V}(T) =  \left[ \Gamma(\frac{2}{a} + 1) - \Gamma^2(\frac{1}{a} + 1)\right] \frac{1}{\sqrt[a]{\mu^2} }$$ |                                                   $$ \mathbb{V}(T) = (\exp(\sigma^2) -1) \exp(2\mu+\sigma^2)$$                                                  | -->
<!-- The distribution function is deduced from the survival function from the following formula :  -->
<!-- $$ -->
<!--      F(t|X) = 1 - S(t|X).  -->
<!-- $$ -->
<!-- For data generation, if $Y$ is a random variable that follows a probability distribution $F,$ then $U = F(Y)$ follows a uniform distribution over the interval $[0.1],$ and $(1-U)$ also follows a uniform distribution $\mathcal{U}[0.1].$ From the previous equation, we finally obtain that :  -->
<!-- $$ -->
<!--      1 - U = S(t|X) = \exp(-H_0(\psi_1(X)t)\psi_2(X)) % \sim \mathcal{U} [0,1]. -->
<!--      $$ -->
<!--      <!-- \\ %\sim \mathcal{U} [0.1] \\ -->
<!-- $$ 1-U = \exp(-H_0(\psi_1(X)t)\psi_2(X)) % \sim \mathcal{U} [0,1]. $$ -->
<!-- %\textcolor{red}{equivalent do not put = ?}\label{eq:U} -->
<!-- If $\alpha_0(t)$ is positive for any $t,$ then $H_0(t)$ can be inverted and the survival time of each of the considered models (Cox, AFT, and AH) express starting from $H_0^{-1}(u).$ The expression of the survival times for each of the models is presented in the table above and is written in a general way :  -->
<!--  $$ -->
<!--       T = \frac{1}{\psi_1(X)} H^{-1}_0 \left( \frac{\log(1-U)}{\psi_2(X)} \right), \text{with} -->
<!--   $$ -->
<!-- where the set $(\psi_1(X), \psi_2(X))$ is equal to $(1, \exp(\beta^TX_{i.})$ for Cox's model, to $(\exp(-\beta^TX_{i.)). }, \exp(-\beta^TX_{i.})$ for an AFT model and $(\exp(-\beta^TX_{i.}, 1)$ for an AH model. -->
<!-- $$ -->
<!-- (\psi_1(X), \psi_2(X)) = \left\{ -->
<!--     \begin{array}{ll} -->
<!--         (1, \exp(\beta^TX)) & \mbox{for Cox's model } \\ -->
<!--         (\exp(\beta^TX), \exp(-\beta^TX)) & \mbox{for model AH} \\\ -->
<!--         (\exp(\beta^TX), 1) & \mbox{for an AFT model. }  -->
<!--     \end{array} -->
<!-- \right. -->
<!-- $$ -->
<!-- Two distributions were proposed for the cumulative risk function $H_0(t)$ to generate the survival data. If the survival times are distributed according to a Weibull distribution $\mathcal{W}(a, \lambda),$ the baseline risk is of the form :  -->
<!-- $$ -->
<!--     \alpha_0(t) = a\lambda t^{a-1}, \lambda > 0, a > 0. -->
<!-- $$ -->
<!-- The cumulative risk function is therefore written as follows:  -->
<!-- $$ -->
<!--     H_0(t) = \lambda t^{a}, \lambda > 0, a > 0 -->
<!-- $$ -->
<!--  and the inverse of this function is expressed as follows: -->
<!--  $$ -->
<!--      H_0^{-1}(u) = \left( \frac{u}{\lambda} \right)^{1/a}. -->
<!--  $$ -->
<!--  In a second step, we considered that the survival times followed a log-normal $\mathcal{LN}(\mu, \sigma)$ distribution of mean $\mu$ and standard deviation $\sigma$. The basic risk function is therefore written as :  -->
<!--  $$ -->
<!--      \alpha_0(t) = \frac{\frac{\frac{1}{\sigma\sqrt{2\pi t}}} \exp\left[-\frac{(\log t - \mu)^2 }{2 \sigma^2}\right]}{1 - \Phi\left[\frac{\log t - \mu}{\sigma}\right]}, -->
<!--  $$ -->
<!--  with $\Phi(t)$ the distribution function of a centered and reduced normal distribution. The cumulative risk function is written as :  -->
<!--  $$ -->
<!--      H_0(t) = - \log\left [1 - \Phi\left(\frac{\log t - \mu}{\sigma}\right)\right] -->
<!--  $$ -->
<!--  and therefore the inverse of this function is expressed by :  -->
<!--  $$ -->
<!--      H_0^{-1}(u) = \exp(\sigma\Phi^{-1}(1-\exp(-u))+\mu), -->
<!--  $$ -->
<!--  with $\Phi^{-1}(t)$ the inverse of the distribution function of a centered and reduced normal distribution. -->
<!--  As specified in Section~\ref{sec:chap3_intro}, we have simulated the survival data from three different models. The first model considered is a Cox model, whose baseline risk function distribution can be a Weibull or a log-normale distribution. This simulation allows us to have survival data by checking the proportional risks. -->
<!--  The second model for data simulation is an AFT model associated with the Weibull or log-normal distribution for the baseline risk function.  -->
<!--  With an AFT model, the risks are not proportional. But the survival curves are parallel as for a Cox model.  More complex simulated data, with intersecting survival curves,  can get from a modified version of an AFT model can be used. We can also generate data more complicated with an AH model whose baseline risk distribution can be the log-normal or Weibull distribution. -->
</div>
<div id="simulation-from-a-cox-model" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation-from-a-cox-model" class="anchor"></a>2 Simulation from a Cox model</h1>
<p>The package survMS can simulate data from a Cox model. We have chosen to carry out this simulation to generate survival data that respects the proportional risk hypothesis. For more details, see <a href="https://mathildesautreuil.github.io/survMS/articles/How-to-simulate-survival-models.html">Vignette</a>. Survival times can follow different distributions: Weibull, log-normal, exponential (in progress) and Gompertz (in progress).</p>
<div id="simulation-from-a-cox-model-with-baseline-hazard-following-weibull-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-from-a-cox-model-with-baseline-hazard-following-weibull-distribution" class="anchor"></a>2.1 Simulation from a Cox model with baseline hazard following Weibull distribution</h2>
<p>To simulate survival data checking the proportional risk hypothesis, we use a Cox model with survival times following a Weibull distribution.</p>
<!-- We recall that the generation of survival data from a Cox model based on :  -->
<!-- $$ -->
<!--     T = H_0^{-1} \left[ \frac{-\log(1-U)}{\exp(\beta^T X_{i.})}\right], -->
<!-- $$ -->
<!-- where $U \sim \mathcal{U} [0.1].$ -->
<!-- For this simulation, we consider that survival times follow a Weibull's law $\mathcal{W}(a,\lambda).$ In this case, we have the cumulative risk function expressed by :  -->
<!-- $$ -->
<!--     H_0(t) = - \log\left [1 - \Phi\left(\frac{\log t - \mu}{\sigma}\right)\right] -->
<!-- $$ -->
<!-- and survival times can therefore be simulated from :  -->
<!-- $$ -->
<!--     T = \frac{1}{\lambda^{1/a}} \left( \frac{-\log(1-U)}{\exp(\beta^T X_{i.})} \right)^{1/a} .  -->
<!-- $$ -->
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramW</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_weib.html">get_param_weib</a></span><span class="op">(</span>med <span class="op">=</span> <span class="fl">1062</span>, mu <span class="op">=</span> <span class="fl">1134</span><span class="op">)</span>
<span class="co"># c(res_paramW$a, res_paramW$lambda)</span>
<span class="va">listCoxWSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"cox"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>, 
                                   p <span class="op">=</span> <span class="fl">1000</span>, pnonull <span class="op">=</span> <span class="fl">20</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"weibull"</span>, 
                                   hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "cox", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="co">#&gt; [1] 3 4</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">listCoxWSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_cox_model-1.png" width="100%"></p>
</div>
<div id="simulation-from-a-cox-model-with-baseline-hazard-following-log-normal-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-from-a-cox-model-with-baseline-hazard-following-log-normal-distribution" class="anchor"></a>2.2 Simulation from a Cox model with baseline hazard following log-normal distribution</h2>
<p>To simulate survival data checking the proportional risk hypothesis, we use a Cox model with survival times following a log-normal distribution.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramLN</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_ln.html">get_param_ln</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">170000</span>, mu <span class="op">=</span> <span class="fl">2320</span><span class="op">)</span>
<span class="va">listCoxSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"cox"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>, 
                                  p <span class="op">=</span> <span class="fl">1000</span>, pnonull <span class="op">=</span> <span class="fl">20</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"log-normal"</span>, 
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">res_paramLN</span><span class="op">$</span><span class="va">a</span>, <span class="va">res_paramLN</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "cox", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">listCoxSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_coxLN_model-1.png" width="100%"></p>
</div>
</div>
<div id="simulation-from-an-aft-model" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation-from-an-aft-model" class="anchor"></a>3 Simulation from an AFT model</h1>
<p>From survMS package, we can simulate the data from an AFT model. We have chosen to carry out this simulation to generate survival data that does not respect the proportional risk hypothesis. For more details, see <a href="https://mathildesautreuil.github.io/survMS/articles/How-to-simulate-survival-models.html">Vignette</a>. Survival times can follow different distributions: Weibull, log-normal, exponential (in progress) and Gompertz (in progress).</p>
<div id="simulation-from-an-aft-model-with-baseline-hazard-following-weibull-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-from-an-aft-model-with-baseline-hazard-following-weibull-distribution" class="anchor"></a>3.1 Simulation from an AFT model with baseline hazard following Weibull distribution</h2>
<p>To simulate survival data not checking the proportional risk hypothesis, we use an AFT model with survival times following a weibull distribution.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramW</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_weib.html">get_param_weib</a></span><span class="op">(</span>med <span class="op">=</span> <span class="fl">1062</span>, mu <span class="op">=</span> <span class="fl">1134</span><span class="op">)</span>
<span class="co"># c(res_paramW$a, res_paramW$lambda)</span>
<span class="va">listAFTWSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"AFT"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>, 
                                  p <span class="op">=</span> <span class="fl">1000</span>, pnonull <span class="op">=</span> <span class="fl">20</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"weibull"</span>, 
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "AFT", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">listAFTWSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_aftW_model-1.png" width="100%"></p>
</div>
<div id="simulation-from-an-aft-model-with-baseline-hazard-following-log-normal-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-from-an-aft-model-with-baseline-hazard-following-log-normal-distribution" class="anchor"></a>3.2 Simulation from an AFT model with baseline hazard following log-normal distribution</h2>
<p>To simulate survival data not checking the proportional risk hypothesis, we use an AFT model with survival times following a log-normal distribution.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramLN</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_ln.html">get_param_ln</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">170000</span>, mu <span class="op">=</span> <span class="fl">2325</span><span class="op">)</span>
<span class="va">listAFTLNSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"AFT"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>, 
                                  p <span class="op">=</span> <span class="fl">10</span>, pnonull <span class="op">=</span> <span class="fl">10</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"log-normal"</span>, 
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">res_paramLN</span><span class="op">$</span><span class="va">a</span><span class="op">*</span><span class="fl">3</span>, <span class="va">res_paramLN</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "AFT", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">listAFTLNSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_aftLN_model-1.png" width="100%"></p>
<!-- ```{r sim_aft_model} -->
<!-- res_paramLN = get_param_ln(var = 200000, mu = 1134)#compute_param_weibull(a_list = a_list, med = 2280, moy = 2325, var = 1619996) -->
<!-- listAFTLNSim_n500_p1000 <- modelSim(model = "AFT", matDistr = "unif", matParam = c(0,1), n = 500,  -->
<!--                                   p = 100, pnonull = 100, betaDistr = 1, hazDistr = "log-normal", -->
<!--                                   hazParams = c(0.3, res_paramLN$lambda), Phi = 0, seed = 1, d = 0) -->
<!-- hist(listAFTLNSim_n500_p1000) -->
<!-- ``` -->
</div>
<div id="simulation-from-a-shifted-aft-model" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-from-a-shifted-aft-model" class="anchor"></a>3.3 Simulation from a shifted AFT model</h2>
<p>To obtain survival data from a model that does not respect the proportional risk hypothesis and that their survival curves can not cross, we have modified the AFT model by adding a term <em>betaDistr</em> in the model. For more details, see <a href="https://mathildesautreuil.github.io/survMS/articles/How-to-simulate-survival-models.html">Vignette</a>. Survival times can follow different distributions: Weibull, log-normal, exponential (in progress) and Gompertz (in progress).</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramLN</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_ln.html">get_param_ln</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">170000</span>, mu <span class="op">=</span> <span class="fl">2325</span><span class="op">)</span>
<span class="va">listAFTsSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"AFTshift"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>, 
                                  p <span class="op">=</span> <span class="fl">10</span>, pnonull <span class="op">=</span> <span class="fl">10</span>, betaDistr <span class="op">=</span> <span class="st">"unif"</span>, hazDistr <span class="op">=</span> <span class="st">"log-normal"</span>, 
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="va">res_paramLN</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "AFTshift", matDistr = "unif", matParam = c(-1, :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="co">#&gt; Warning in log(mat_grille_ti * (1/as.vector(eta_i)) - matrix(phi2, nrow(Z), :</span>
<span class="co">#&gt; production de NaN</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">listAFTsSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_aft_mod_model-1.png" width="100%"></p>
</div>
</div>
<div id="simulation-from-an-ah-model" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation-from-an-ah-model" class="anchor"></a>4 Simulation from an AH model</h1>
<p>From survMS package, we can also simulated survival data from another model, an AH model. We have chosen to carry out this simulation to generate survival data that does not respect the proportional risk hypothesis and survival curves can cross. For more details, see <a href="https://mathildesautreuil.github.io/survMS/articles/How-to-simulate-survival-models.html">Vignette</a>.</p>
<div id="simulation-from-an-ah-model-with-baseline-hazard-following-weibull-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-from-an-ah-model-with-baseline-hazard-following-weibull-distribution" class="anchor"></a>4.1 Simulation from an AH model with baseline hazard following Weibull distribution</h2>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramW</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_weib.html">get_param_weib</a></span><span class="op">(</span>med <span class="op">=</span> <span class="fl">1062</span>, mu <span class="op">=</span> <span class="fl">1134</span><span class="op">)</span>
<span class="va">listAHwSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"AH"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>,
                                  p <span class="op">=</span> <span class="fl">100</span>, pnonull <span class="op">=</span> <span class="fl">20</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"weibull"</span>,
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">res_paramW</span><span class="op">$</span><span class="va">a</span>, <span class="va">res_paramW</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>,
                                  Phi <span class="op">=</span> <span class="fl">0</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "AH", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">listAHwSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_ah_model-1.png" width="100%"></p>
</div>
<div id="simulation-from-the-an-ah-model-with-baseline-hazard-following-log-normal-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-from-the-an-ah-model-with-baseline-hazard-following-log-normal-distribution" class="anchor"></a>4.2 Simulation from the an AH model with baseline hazard following log-normal distribution</h2>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramLN</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_ln.html">get_param_ln</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">170000</span>, mu <span class="op">=</span> <span class="fl">2325</span><span class="op">)</span>
<span class="va">listAHSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"AH"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>,
                                  p <span class="op">=</span> <span class="fl">100</span>, pnonull <span class="op">=</span> <span class="fl">100</span>, betaDistr <span class="op">=</span> <span class="fl">1.5</span>, hazDistr <span class="op">=</span> <span class="st">"log-normal"</span>,
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">res_paramLN</span><span class="op">$</span><span class="va">a</span><span class="op">*</span><span class="fl">4</span>, <span class="va">res_paramLN</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, Phi <span class="op">=</span> <span class="fl">0</span>, 
                                 seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "AH", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="co"># summary(listAHSim_n500_p1000)</span>
<span class="co"># print(listAHSim_n500_p1000)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">listAHSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_ahLN_model-1.png" width="100%"></p>
</div>
</div>
<div id="utils-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#utils-functions" class="anchor"></a>5 Utils functions</h1>
<!-- The package enables simulating data close to real datasets. In this goal, we have to know the mean, median, and variance of real datasets and then compute the parameters of the used distribution to have a similar distribution of survival times by giving the mean, median, and variance. -->
<div id="get-parameters-of-survival-time-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#get-parameters-of-survival-time-distribution" class="anchor"></a>5.1 Get parameters of survival time distribution</h2>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Weibull distribution</span>
<span class="va">res_paramW</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_weib.html">get_param_weib</a></span><span class="op">(</span>med <span class="op">=</span> <span class="fl">1062</span>, mu <span class="op">=</span> <span class="fl">1134</span><span class="op">)</span>
<span class="va">res_paramW</span>
<span class="co">#&gt; $a</span>
<span class="co">#&gt; [1] 1.969765</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lambda</span>
<span class="co">#&gt; [1] 7.586963e-07</span>
<span class="co"># Log-normale distribution</span>
<span class="va">res_paramLN</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_ln.html">get_param_ln</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">600000</span>, mu <span class="op">=</span> <span class="fl">1134</span><span class="op">)</span>
<span class="va">res_paramLN</span>
<span class="co">#&gt; $a</span>
<span class="co">#&gt; [1] 0.6188154</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lambda</span>
<span class="co">#&gt; [1] 6.84204</span></code></pre></div>
</div>
<div id="plotting-survival-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-survival-curves" class="anchor"></a>5.2 Plotting survival curves</h2>
<div id="coxweibull-model" class="section level3">
<h3 class="hasAnchor">
<a href="#coxweibull-model" class="anchor"></a>5.2.1 Cox/Weibull model</h3>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="fl">8</span><span class="op">)</span>
<span class="co">## Cox/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">listCoxWSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-surv_curves-1.png" width="100%"></p>
</div>
<div id="aftlog-normal-model" class="section level3">
<h3 class="hasAnchor">
<a href="#aftlog-normal-model" class="anchor"></a>5.2.2 AFT/Log-normal model</h3>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## AFT/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">listAFTLNSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-surv_curves_aft-1.png" width="100%"></p>
</div>
<div id="shifted-aftlog-normal-model" class="section level3">
<h3 class="hasAnchor">
<a href="#shifted-aftlog-normal-model" class="anchor"></a>5.2.3 Shifted AFT/Log-normal model</h3>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Shifted AFT/LN model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">listAFTsSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-surv_curves_afts-1.png" width="100%"></p>
</div>
<div id="ahln-model" class="section level3">
<h3 class="hasAnchor">
<a href="#ahln-model" class="anchor"></a>5.2.4 AH/LN model</h3>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cox/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="co"># set.seed(765)</span>
<span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="fl">8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">listAHSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-surv_curves_ah-1.png" width="100%"></p>
</div>
</div>
<div id="plotting-hazard-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-hazard-curves" class="anchor"></a>5.3 Plotting hazard curves</h2>
<div id="coxweibull-model-1" class="section level3">
<h3 class="hasAnchor">
<a href="#coxweibull-model-1" class="anchor"></a>5.3.1 Cox/Weibull model</h3>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cox/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">listCoxWSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span>, type <span class="op">=</span> <span class="st">"hazard"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-haz_curves-1.png" width="100%"></p>
</div>
<div id="aftweibull-model" class="section level3">
<h3 class="hasAnchor">
<a href="#aftweibull-model" class="anchor"></a>5.3.2 AFT/Weibull model</h3>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## AFT/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">listAFTWSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span>, type <span class="op">=</span> <span class="st">"hazard"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-haz_curves_aft-1.png" width="100%"></p>
</div>
<div id="aftlog-normal-model-1" class="section level3">
<h3 class="hasAnchor">
<a href="#aftlog-normal-model-1" class="anchor"></a>5.3.3 AFT/Log-normal model</h3>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## AFT/LN model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">listAFTLNSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span>, type <span class="op">=</span> <span class="st">"hazard"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-haz_curves_aftLN-1.png" width="100%"></p>
</div>
<div id="shifted-aftlog-normal-model-1" class="section level3">
<h3 class="hasAnchor">
<a href="#shifted-aftlog-normal-model-1" class="anchor"></a>5.3.4 Shifted AFT/Log-normal model</h3>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Shifted AFT/LN model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">listAFTsSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span>, type <span class="op">=</span> <span class="st">"hazard"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-haz_curves_afts-1.png" width="100%"></p>
</div>
<div id="ahln-model-1" class="section level3">
<h3 class="hasAnchor">
<a href="#ahln-model-1" class="anchor"></a>5.3.5 AH/LN model</h3>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cox/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">listAHSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span>, type <span class="op">=</span> <span class="st">"hazard"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-haz_curves_ah-1.png" width="100%"></p>
</div>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>6 Examples</h1>
<p>Please also see the package <a href="https://mathildesautreuil.github.io/survMS/articles/How-to-simulate-survival-models.html">vignette</a> for more detailed examples and a description of the methodology underpinning the <strong>survMS</strong> package.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/mathildesautreuil/survMS/">https://​github.com/​mathildesautreuil/​survMS/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/mathildesautreuil/survMS/issues%20%20">https://​github.com/​mathildesautreuil/​survMS/​issues  </a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://mathildesautreuil.github.io/">Mathilde Sautreuil</a> <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=survMS"><img src="https://www.r-pkg.org/badges/version/survMS"></a></li>
<li><a href="https://github.com/tidyverse/dplyr/actions?workflow=R-CMD-check"><img src="https://github.com/tidyverse/dplyr/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://mathildesautreuil.github.io/">Mathilde Sautreuil</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Survival Model Simulation • survMS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Survival Model Simulation">
<meta property="og:description" content="Package enables the data simulation from different survival models (Cox, AFT, and AH models). The simulated data will have various levels of complexity according to the survival model considered. The implemented methods for the Cox model are described in Ralf Bender, Thomas Augustin, Maria Blettner (2004) &lt;doi:10.1002/sim.2059&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">survMS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="articles/index.html">
    <span class="fa fa-book"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-code"></span>
     
    Functions Documentation
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mathildesautreuil/survMS" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="survms-r-package-survival-model-simulation">survMS R package: survival Model Simulation<a class="anchor" aria-label="anchor" href="#survms-r-package-survival-model-simulation"></a>
</h1></div>
<!-- README.md is generated from README.Rmd. Please edit that file --><!-- <img src="docs/reference/survMS.png" align="right" height=150/> --><p><img src="https://raw.githubusercontent.com/mathildesautreuil/survMS/master/docs/reference/survMS.png" height="2" align="right"></p>
<!-- [![CRAN_Status_Badge](https://www.r-pkg.org/badges/version/survMS)](https://CRAN.R-project.org/package=survMS) --><p><a href="https://cran.r-project.org/package=survMS" class="external-link"><img src="https://www.r-pkg.org/badges/version/survMS?color=bc8f8f"></a> <a href="https://cran.r-project.org/package=survMS" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/survMS?color=8fbcbc"></a> <!-- [![](http://cranlogs.r-pkg.org/badges/grand-total/survMS?color=blue)](https://cran.r-project.org/package=survMS) --></p>
<!-- [![R build status](https://github.com/tidyverse/dplyr/workflows/R-CMD-check/badge.svg)](https://github.com/mathildesautreuil/survMS/actions?workflow=R-CMD-check) --><!-- [![R build status](https://github.com/mathildesautreuil/survMS/workflows/R-CMD-check/badge.svg)](https://github.com/mathildesautreuil/survMS/actions) --><p><a href="https://github.com/mathildesautreuil/survMS//actions" class="external-link"><img src="https://github.com/mathildesautreuil/survMS//workflows/R-CMD-check/badge.svg" alt="R build status"></a> <!-- [![](https://img.shields.io/github/last-commit/mathildesautreuil/survMS.svg)](https://github.com/mathildesautreuil/survMS/commits/master) --></p>
<p><a href="https://mathildesautreuil.github.io/survMS"><img src="https://img.shields.io/badge/survMS-website-bc8f8f.svg"></a></p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>Install from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"survMS"</span><span class="op">)</span></code></pre></div>
<p>Or install the development version from Github:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mathildesautreuil/survMS"</span><span class="op">)</span></code></pre></div>
<p>And load the library:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mathildesautreuil/survMS/" class="external-link">survMS</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Loading required package: ComplexHeatmap</span>
<span class="co">#&gt; Loading required package: grid</span>
<span class="co">#&gt; ========================================</span>
<span class="co">#&gt; ComplexHeatmap version 2.13.1</span>
<span class="co">#&gt; Bioconductor page: http://bioconductor.org/packages/ComplexHeatmap/</span>
<span class="co">#&gt; Github page: https://github.com/jokergoo/ComplexHeatmap</span>
<span class="co">#&gt; Documentation: http://jokergoo.github.io/ComplexHeatmap-reference</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; If you use it in published research, please cite:</span>
<span class="co">#&gt; Gu, Z. Complex heatmaps reveal patterns and correlations in multidimensional </span>
<span class="co">#&gt;   genomic data. Bioinformatics 2016.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The new InteractiveComplexHeatmap package can directly export static </span>
<span class="co">#&gt; complex heatmaps into an interactive Shiny app with zero effort. Have a try!</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This message can be suppressed by:</span>
<span class="co">#&gt;   suppressPackageStartupMessages(library(ComplexHeatmap))</span>
<span class="co">#&gt; ========================================</span>
<span class="co">#&gt; Loading required package: circlize</span>
<span class="co">#&gt; ========================================</span>
<span class="co">#&gt; circlize version 0.4.15</span>
<span class="co">#&gt; CRAN page: https://cran.r-project.org/package=circlize</span>
<span class="co">#&gt; Github page: https://github.com/jokergoo/circlize</span>
<span class="co">#&gt; Documentation: https://jokergoo.github.io/circlize_book/book/</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; If you use it in published research, please cite:</span>
<span class="co">#&gt; Gu, Z. circlize implements and enhances circular visualization</span>
<span class="co">#&gt;   in R. Bioinformatics 2014.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This message can be suppressed by:</span>
<span class="co">#&gt;   suppressPackageStartupMessages(library(circlize))</span>
<span class="co">#&gt; ========================================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'survMS'</span>
<span class="co">#&gt; The following object is masked from 'package:ComplexHeatmap':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Heatmap</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="1-introduction">1 Introduction<a class="anchor" aria-label="anchor" href="#1-introduction"></a>
</h1>
<p><strong>survMS</strong> is an R package that generates survival data from different survival models with varying levels of complexity. Three survival models are implemented in the package to simulate survival data: a Cox model, an Accelerated Failure Time (AFT) model, and an Accelerated Hazard (AH) model. These models have their specificities. Indeed, a Cox model is a proportional risk model, not an AFT and an AH model. A proportional risk model means that the ratio of the risks between two individuals with different explanatory variables does not depend on the time. In an AFT model, the explanatory variables have an accelerating or decelerating effect on individuals’ survival. In both models, a Cox model and an AFT model, the survival function’s curves never intersect. When one is interested in more complex data with intersecting survival curves, for example, to make it more difficult for methods to predict survival, two approaches are implemented in the package. The first approach consists of modifying an AFT model to have intersecting survival curves. The second approach concerns using of an AH model (for <em>Accelerated Hazards</em>) to generate the survival data. an AH model is more flexible than the two models mentioned above. In an AH model, the variables accelerate or decelerate the hazard risk. The survival curves of an AH model can therefore cross each other. The generation of survival times carried out from the different models mentioned above. The baseline risk function of the models is assumed to be known and follows a particular probability distribution. For these different models, we use parametric distribution of the baseline risk for the generation of survival time.</p>
<p>Note that we stayed in a linear dependency framework without interaction. We will adapt the package in a second step to be in a nonlinear framework to simulate interactions. The package’s implementation is easily adapted to the nonlinear framework with interactions by replacing the explanatory variables’ linear part with a nonlinear function of the explanatory variables. All the functions in the package are coded to introduce this nonlinear function of the explanatory variables easily.</p>
<p>For details on methodology, see <a href="https://mathildesautreuil.github.io/survMS/articles/how-to-simulate-survival-models.html">Vignette</a>.</p>
</div>
<div class="section level1">
<h1 id="2-simulation-from-a-cox-model">2 Simulation from a Cox model<a class="anchor" aria-label="anchor" href="#2-simulation-from-a-cox-model"></a>
</h1>
<p>The package survMS can simulate data from a Cox model. We have chosen to carry out this simulation to generate survival data that respects the proportional risk hypothesis. For more details, see <a href="https://mathildesautreuil.github.io/survMS/articles/how-to-simulate-survival-models.html">Vignette</a>. Survival times can follow different distributions: Weibull, log-normal, exponential (in progress) and Gompertz (in progress).</p>
<div class="section level2">
<h2 id="21-simulation-from-a-cox-model-with-baseline-hazard-following-weibull-distribution">2.1 Simulation from a Cox model with baseline hazard following Weibull distribution<a class="anchor" aria-label="anchor" href="#21-simulation-from-a-cox-model-with-baseline-hazard-following-weibull-distribution"></a>
</h2>
<p>To simulate survival data checking the proportional risk hypothesis, we use a Cox model with survival times following a Weibull distribution.</p>
<!-- We recall that the generation of survival data from a Cox model based on :  --><!-- $$ --><!--     T = H_0^{-1} \left[ \frac{-\log(1-U)}{\exp(\beta^T X_{i.})}\right], --><!-- $$ --><!-- where $U \sim \mathcal{U} [0.1].$ --><!-- For this simulation, we consider that survival times follow a Weibull's law $\mathcal{W}(a,\lambda).$ In this case, we have the cumulative risk function expressed by :  --><!-- $$ --><!--     H_0(t) = - \log\left [1 - \Phi\left(\frac{\log t - \mu}{\sigma}\right)\right] --><!-- $$ --><!-- and survival times can therefore be simulated from :  --><!-- $$ --><!--     T = \frac{1}{\lambda^{1/a}} \left( \frac{-\log(1-U)}{\exp(\beta^T X_{i.})} \right)^{1/a} .  --><!-- $$ --><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramW</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_weib.html">get_param_weib</a></span><span class="op">(</span>med <span class="op">=</span> <span class="fl">1062</span>, mu <span class="op">=</span> <span class="fl">1134</span><span class="op">)</span>
<span class="co"># c(res_paramW$a, res_paramW$lambda)</span>
<span class="va">listCoxWSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"cox"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>, 
                                   p <span class="op">=</span> <span class="fl">1000</span>, pnonull <span class="op">=</span> <span class="fl">20</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"weibull"</span>, 
                                   hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "cox", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">listCoxWSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_cox_model-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="22-simulation-from-a-cox-model-with-baseline-hazard-following-log-normal-distribution">2.2 Simulation from a Cox model with baseline hazard following log-normal distribution<a class="anchor" aria-label="anchor" href="#22-simulation-from-a-cox-model-with-baseline-hazard-following-log-normal-distribution"></a>
</h2>
<p>To simulate survival data checking the proportional risk hypothesis, we use a Cox model with survival times following a log-normal distribution.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramLN</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_ln.html">get_param_ln</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">170000</span>, mu <span class="op">=</span> <span class="fl">2320</span><span class="op">)</span>
<span class="va">listCoxSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"cox"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>, 
                                  p <span class="op">=</span> <span class="fl">1000</span>, pnonull <span class="op">=</span> <span class="fl">20</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"log-normal"</span>, 
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res_paramLN</span><span class="op">$</span><span class="va">a</span>, <span class="va">res_paramLN</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "cox", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">listCoxSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_coxLN_model-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="23-simulation-from-a-cox-model-with-a-correlated-covariate-matrix">2.3 Simulation from a Cox model with a correlated covariate matrix<a class="anchor" aria-label="anchor" href="#23-simulation-from-a-cox-model-with-a-correlated-covariate-matrix"></a>
</h2>
<p>For this simulation, we consider the same design as 2.1 to simulate survival times. However, the simulated covariate matrix is correlated. The pertinent covariates are those correlated. We split this set of pertinent covariates in two subsets: one with a correlation parameter (<em>matParam[2]</em>) and the other one with (1 - <em>matParam[2]</em>). The non-pertinent covariates are uncorrelated.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramW</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_weib.html">get_param_weib</a></span><span class="op">(</span>med <span class="op">=</span> <span class="fl">2.5</span>, mu <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span>
<span class="va">listCoxSimCor_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"cox"</span>, matDistr <span class="op">=</span> <span class="st">"mvnorm"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>,
                                  p <span class="op">=</span> <span class="fl">1000</span>, pnonull <span class="op">=</span> <span class="fl">10</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"weibull"</span>,
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res_paramW</span><span class="op">$</span><span class="va">a</span>, <span class="va">res_paramW</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "cox", matDistr = "mvnorm", matParam = c(0, :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="fu"><a href="reference/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">listCoxSimCor_n500_p1000</span>, ind <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_cox_model_cor-1.png" width="100%"></p>
</div>
</div>
<div class="section level1">
<h1 id="3-simulation-from-an-aft-model">3 Simulation from an AFT model<a class="anchor" aria-label="anchor" href="#3-simulation-from-an-aft-model"></a>
</h1>
<p>From survMS package, we can simulate the data from an AFT model. We have chosen to carry out this simulation to generate survival data that does not respect the proportional risk hypothesis. For more details, see <a href="https://mathildesautreuil.github.io/survMS/articles/how-to-simulate-survival-models.html">Vignette</a>. Survival times can follow different distributions: Weibull, log-normal, exponential (in progress) and Gompertz (in progress).</p>
<div class="section level2">
<h2 id="31-simulation-from-an-aft-model-with-baseline-hazard-following-weibull-distribution">3.1 Simulation from an AFT model with baseline hazard following Weibull distribution<a class="anchor" aria-label="anchor" href="#31-simulation-from-an-aft-model-with-baseline-hazard-following-weibull-distribution"></a>
</h2>
<p>To simulate survival data not checking the proportional risk hypothesis, we use an AFT model with survival times following a weibull distribution.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramW</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_weib.html">get_param_weib</a></span><span class="op">(</span>med <span class="op">=</span> <span class="fl">1062</span>, mu <span class="op">=</span> <span class="fl">1134</span><span class="op">)</span>
<span class="co"># c(res_paramW$a, res_paramW$lambda)</span>
<span class="va">listAFTWSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"AFT"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>, 
                                  p <span class="op">=</span> <span class="fl">1000</span>, pnonull <span class="op">=</span> <span class="fl">20</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"weibull"</span>, 
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "AFT", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">listAFTWSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_aftW_model-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="32-simulation-from-an-aft-model-with-baseline-hazard-following-log-normal-distribution">3.2 Simulation from an AFT model with baseline hazard following log-normal distribution<a class="anchor" aria-label="anchor" href="#32-simulation-from-an-aft-model-with-baseline-hazard-following-log-normal-distribution"></a>
</h2>
<p>To simulate survival data not checking the proportional risk hypothesis, we use an AFT model with survival times following a log-normal distribution.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramLN</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_ln.html">get_param_ln</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">170000</span>, mu <span class="op">=</span> <span class="fl">2325</span><span class="op">)</span>
<span class="va">listAFTLNSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"AFT"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>, 
                                  p <span class="op">=</span> <span class="fl">10</span>, pnonull <span class="op">=</span> <span class="fl">10</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"log-normal"</span>, 
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res_paramLN</span><span class="op">$</span><span class="va">a</span><span class="op">*</span><span class="fl">3</span>, <span class="va">res_paramLN</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "AFT", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">listAFTLNSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_aftLN_model-1.png" width="100%"></p>
<!-- ```{r sim_aft_model} --><!-- res_paramLN = get_param_ln(var = 200000, mu = 1134)#compute_param_weibull(a_list = a_list, med = 2280, moy = 2325, var = 1619996) --><!-- listAFTLNSim_n500_p1000 <- modelSim(model = "AFT", matDistr = "unif", matParam = c(0,1), n = 500,  --><!--                                   p = 100, pnonull = 100, betaDistr = 1, hazDistr = "log-normal", --><!--                                   hazParams = c(0.3, res_paramLN$lambda), Phi = 0, seed = 1, d = 0) --><!-- hist(listAFTLNSim_n500_p1000) --><!-- ``` -->
</div>
<div class="section level2">
<h2 id="33-simulation-from-a-shifted-aft-model">3.3 Simulation from a shifted AFT model<a class="anchor" aria-label="anchor" href="#33-simulation-from-a-shifted-aft-model"></a>
</h2>
<p>To obtain survival data from a model that does not respect the proportional risk hypothesis and that their survival curves can not cross, we have modified the AFT model by adding a term <em>betaDistr</em> in the model. For more details, see <a href="https://mathildesautreuil.github.io/survMS/articles/how-to-simulate-survival-models.html">Vignette</a>. Survival times can follow different distributions: Weibull, log-normal, exponential (in progress) and Gompertz (in progress).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramLN</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_ln.html">get_param_ln</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">170000</span>, mu <span class="op">=</span> <span class="fl">2325</span><span class="op">)</span>
<span class="va">listAFTsSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"AFTshift"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>, 
                                  p <span class="op">=</span> <span class="fl">10</span>, pnonull <span class="op">=</span> <span class="fl">10</span>, betaDistr <span class="op">=</span> <span class="st">"unif"</span>, hazDistr <span class="op">=</span> <span class="st">"log-normal"</span>, 
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="va">res_paramLN</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "AFTshift", matDistr = "unif", matParam = c(-1, :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="co">#&gt; Warning in log(mat_grille_ti * (1/as.vector(eta_i)) - matrix(phi2, nrow(Z), :</span>
<span class="co">#&gt; production de NaN</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">listAFTsSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_aft_mod_model-1.png" width="100%"></p>
</div>
</div>
<div class="section level1">
<h1 id="4-simulation-from-an-ah-model">4 Simulation from an AH model<a class="anchor" aria-label="anchor" href="#4-simulation-from-an-ah-model"></a>
</h1>
<p>From survMS package, we can also simulated survival data from another model, an AH model. We have chosen to carry out this simulation to generate survival data that does not respect the proportional risk hypothesis and survival curves can cross. For more details, see <a href="https://mathildesautreuil.github.io/survMS/articles/how-to-simulate-survival-models.html">Vignette</a>.</p>
<div class="section level2">
<h2 id="41-simulation-from-an-ah-model-with-baseline-hazard-following-weibull-distribution">4.1 Simulation from an AH model with baseline hazard following Weibull distribution<a class="anchor" aria-label="anchor" href="#41-simulation-from-an-ah-model-with-baseline-hazard-following-weibull-distribution"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramW</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_weib.html">get_param_weib</a></span><span class="op">(</span>med <span class="op">=</span> <span class="fl">1062</span>, mu <span class="op">=</span> <span class="fl">1134</span><span class="op">)</span>
<span class="va">listAHwSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"AH"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>,
                                  p <span class="op">=</span> <span class="fl">100</span>, pnonull <span class="op">=</span> <span class="fl">20</span>, betaDistr <span class="op">=</span> <span class="fl">1</span>, hazDistr <span class="op">=</span> <span class="st">"weibull"</span>,
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res_paramW</span><span class="op">$</span><span class="va">a</span>, <span class="va">res_paramW</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>,
                                  Phi <span class="op">=</span> <span class="fl">0</span>, seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "AH", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">listAHwSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_ah_model-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="42-simulation-from-the-an-ah-model-with-baseline-hazard-following-log-normal-distribution">4.2 Simulation from the an AH model with baseline hazard following log-normal distribution<a class="anchor" aria-label="anchor" href="#42-simulation-from-the-an-ah-model-with-baseline-hazard-following-log-normal-distribution"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_paramLN</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_ln.html">get_param_ln</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">170000</span>, mu <span class="op">=</span> <span class="fl">2325</span><span class="op">)</span>
<span class="va">listAHSim_n500_p1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/modelSim.html">modelSim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"AH"</span>, matDistr <span class="op">=</span> <span class="st">"unif"</span>, matParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">500</span>,
                                  p <span class="op">=</span> <span class="fl">100</span>, pnonull <span class="op">=</span> <span class="fl">100</span>, betaDistr <span class="op">=</span> <span class="fl">1.5</span>, hazDistr <span class="op">=</span> <span class="st">"log-normal"</span>,
                                  hazParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res_paramLN</span><span class="op">$</span><span class="va">a</span><span class="op">*</span><span class="fl">4</span>, <span class="va">res_paramLN</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, Phi <span class="op">=</span> <span class="fl">0</span>, 
                                 seed <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Warning in modelSim(model = "AH", matDistr = "unif", matParam = c(-1, 1), :</span>
<span class="co">#&gt; Options "non-linearity with interactions" not available</span>
<span class="co"># summary(listAHSim_n500_p1000)</span>
<span class="co"># print(listAHSim_n500_p1000)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">listAHSim_n500_p1000</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sim_ahLN_model-1.png" width="100%"></p>
</div>
</div>
<div class="section level1">
<h1 id="5-utils-functions">5 Utils functions<a class="anchor" aria-label="anchor" href="#5-utils-functions"></a>
</h1>
<!-- The package enables simulating data close to real datasets. In this goal, we have to know the mean, median, and variance of real datasets and then compute the parameters of the used distribution to have a similar distribution of survival times by giving the mean, median, and variance. --><div class="section level2">
<h2 id="51-get-parameters-of-survival-time-distribution">5.1 Get parameters of survival time distribution<a class="anchor" aria-label="anchor" href="#51-get-parameters-of-survival-time-distribution"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Weibull distribution</span>
<span class="va">res_paramW</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_weib.html">get_param_weib</a></span><span class="op">(</span>med <span class="op">=</span> <span class="fl">1062</span>, mu <span class="op">=</span> <span class="fl">1134</span><span class="op">)</span>
<span class="va">res_paramW</span>
<span class="co">#&gt; $a</span>
<span class="co">#&gt; [1] 1.969765</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lambda</span>
<span class="co">#&gt; [1] 7.586963e-07</span>
<span class="co"># Log-normale distribution</span>
<span class="va">res_paramLN</span> <span class="op">=</span> <span class="fu"><a href="reference/get_param_ln.html">get_param_ln</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">600000</span>, mu <span class="op">=</span> <span class="fl">1134</span><span class="op">)</span>
<span class="va">res_paramLN</span>
<span class="co">#&gt; $a</span>
<span class="co">#&gt; [1] 0.6188154</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lambda</span>
<span class="co">#&gt; [1] 6.84204</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="52-plotting-survival-curves">5.2 Plotting survival curves<a class="anchor" aria-label="anchor" href="#52-plotting-survival-curves"></a>
</h2>
<div class="section level3">
<h3 id="521-coxweibull-model">5.2.1 Cox/Weibull model<a class="anchor" aria-label="anchor" href="#521-coxweibull-model"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="fl">8</span><span class="op">)</span>
<span class="co">## Cox/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listCoxWSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-surv_curves-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="522-aftlog-normal-model">5.2.2 AFT/Log-normal model<a class="anchor" aria-label="anchor" href="#522-aftlog-normal-model"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## AFT/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listAFTLNSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-surv_curves_aft-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="523-shifted-aftlog-normal-model">5.2.3 Shifted AFT/Log-normal model<a class="anchor" aria-label="anchor" href="#523-shifted-aftlog-normal-model"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Shifted AFT/LN model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listAFTsSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-surv_curves_afts-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="524-ahln-model">5.2.4 AH/LN model<a class="anchor" aria-label="anchor" href="#524-ahln-model"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cox/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="co"># set.seed(765)</span>
<span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="fl">8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listAHSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-surv_curves_ah-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="53-plotting-hazard-curves">5.3 Plotting hazard curves<a class="anchor" aria-label="anchor" href="#53-plotting-hazard-curves"></a>
</h2>
<div class="section level3">
<h3 id="531-coxweibull-model">5.3.1 Cox/Weibull model<a class="anchor" aria-label="anchor" href="#531-coxweibull-model"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cox/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listCoxWSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span>, type <span class="op">=</span> <span class="st">"hazard"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-haz_curves-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="532-aftweibull-model">5.3.2 AFT/Weibull model<a class="anchor" aria-label="anchor" href="#532-aftweibull-model"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## AFT/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listAFTWSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span>, type <span class="op">=</span> <span class="st">"hazard"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-haz_curves_aft-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="533-aftlog-normal-model">5.3.3 AFT/Log-normal model<a class="anchor" aria-label="anchor" href="#533-aftlog-normal-model"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## AFT/LN model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listAFTLNSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span>, type <span class="op">=</span> <span class="st">"hazard"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-haz_curves_aftLN-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="534-shifted-aftlog-normal-model">5.3.4 Shifted AFT/Log-normal model<a class="anchor" aria-label="anchor" href="#534-shifted-aftlog-normal-model"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Shifted AFT/LN model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listAFTsSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span>, type <span class="op">=</span> <span class="st">"hazard"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-haz_curves_afts-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="535-ahln-model">5.3.5 AH/LN model<a class="anchor" aria-label="anchor" href="#535-ahln-model"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cox/Weibull model</span>
<span class="co"># df_p1000_n500[1:6,1:10]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">listAHSim_n500_p1000</span>, ind <span class="op">=</span> <span class="va">ind</span>, type <span class="op">=</span> <span class="st">"hazard"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-haz_curves_ah-1.png" width="100%"></p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="6-examples">6 Examples<a class="anchor" aria-label="anchor" href="#6-examples"></a>
</h1>
<p>Please also see the package <a href="https://mathildesautreuil.github.io/survMS/articles/how-to-simulate-survival-models.html">vignette</a> for more detailed examples and a description of the methodology underpinning the <strong>survMS</strong> package.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=survMS" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/mathildesautreuil/survMS/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mathildesautreuil/survMS/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing survMS</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://mathildesautreuil.github.io/" class="external-link">Mathilde Sautreuil</a> <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://mathildesautreuil.github.io/" class="external-link">Mathilde Sautreuil</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
